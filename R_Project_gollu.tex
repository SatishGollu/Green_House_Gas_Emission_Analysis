% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={R-GHGs\_Project},
  pdfauthor={Satish Gollu},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering

\title{R-GHGs\_Project}
\author{Satish Gollu}
\date{12/04/2021}

\begin{document}
\maketitle

\begin{verbatim}
     **International Greenhouse Gas Emissions Data Analysis**
\end{verbatim}

The Greenhouse Gas (GHG) Inventory Data contains the most recently
submitted information, covering the period from 1990 to the latest
available year, to the extent the data have been provided. The GHG data
contain information on anthropogenic emissions (These activities that
includes the burning of fossil fuels, deforestation, land use changes,
livestock, fertilization, etc., that result in a net increase in
emissions) by sources and removals by sinks of the following GHGs
(carbon dioxide (CO2), methane (CH4), nitrous oxide (N2O),
hydrofluorocarbons (HFCs), perfluorocarbons (PFCs), unspecified mix of
HFCs and PFCs, sulphur hexafluoride (SF6) and nitrogen triflouride
(NF3)) that are not controlled by the Montreal Protocol. Montreal
protocal is an international agreement made in 1987. It was designed to
stop the production and import of ozone depleting substances and reduce
their concentration in the atmosphere to help protect the earth's ozone
layer.

\textbf{1.Data Loading} The dataset here consists the values of
different gas for different countries from 1990 to 2018.

In details, these are information on anthropogenic emissions by sources
and removals by sinks of the following GHGs: carbon dioxide (CO2)
methane (CH4) nitrous oxide (N2O) hydrofluorocarbons (HFCs)
perfluorocarbons (PFCs) unspecified mix of HFCs and PFCs sulphur
hexafluoride (SF6) nitrogen triflouride (NF3)

Let's load the data and loading all the required packages for the
analysis

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(dplyr)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Attaching package: 'dplyr'
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:stats':
## 
##     filter, lag
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(ggplot2)}

\NormalTok{dataset <-}\StringTok{ }\KeywordTok{read.csv}\NormalTok{(}\StringTok{"greenhouse_gas_inventory_data_data.csv"}\NormalTok{,}\DataTypeTok{sep=}\StringTok{','}\NormalTok{,}\DataTypeTok{stringsAsFactors =} \OtherTok{FALSE}\NormalTok{)}
\KeywordTok{head}\NormalTok{(dataset)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   country_or_area year       value
## 1       Australia 2014  393126.947
## 2       Australia 2013 396913.9365
## 3       Australia 2012 406462.8477
## 4       Australia 2011 403705.5283
## 5       Australia 2010 406200.9932
## 6       Australia 2009  408448.479
##                                                                                                        category
## 1 carbon_dioxide_co2_emissions_without_land_use_land_use_change_and_forestry_lulucf_in_kilotonne_co2_equivalent
## 2 carbon_dioxide_co2_emissions_without_land_use_land_use_change_and_forestry_lulucf_in_kilotonne_co2_equivalent
## 3 carbon_dioxide_co2_emissions_without_land_use_land_use_change_and_forestry_lulucf_in_kilotonne_co2_equivalent
## 4 carbon_dioxide_co2_emissions_without_land_use_land_use_change_and_forestry_lulucf_in_kilotonne_co2_equivalent
## 5 carbon_dioxide_co2_emissions_without_land_use_land_use_change_and_forestry_lulucf_in_kilotonne_co2_equivalent
## 6 carbon_dioxide_co2_emissions_without_land_use_land_use_change_and_forestry_lulucf_in_kilotonne_co2_equivalent
\end{verbatim}

\textbf{2.Data Cleaning}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#checking the dimensions of the dataset}
\KeywordTok{dim}\NormalTok{(dataset)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 9688    4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{str}\NormalTok{(dataset)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 'data.frame':    9688 obs. of  4 variables:
##  $ country_or_area: chr  "Australia" "Australia" "Australia" "Australia" ...
##  $ year           : int  2014 2013 2012 2011 2010 2009 2008 2007 2006 2005 ...
##  $ value          : chr  "393126.947" "396913.9365" "406462.8477" "403705.5283" ...
##  $ category       : chr  "carbon_dioxide_co2_emissions_without_land_use_land_use_change_and_forestry_lulucf_in_kilotonne_co2_equivalent" "carbon_dioxide_co2_emissions_without_land_use_land_use_change_and_forestry_lulucf_in_kilotonne_co2_equivalent" "carbon_dioxide_co2_emissions_without_land_use_land_use_change_and_forestry_lulucf_in_kilotonne_co2_equivalent" "carbon_dioxide_co2_emissions_without_land_use_land_use_change_and_forestry_lulucf_in_kilotonne_co2_equivalent" ...
\end{verbatim}

there are 9688 observations(rows) and 4 parameters (columns) in the
dataset and in columns it have 3 char type variables

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#checking is there any missing values in the dataset}
\KeywordTok{any}\NormalTok{(}\KeywordTok{is.na}\NormalTok{(dataset))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] FALSE
\end{verbatim}

\#it seems there are no missing values in the dataset

if we look at the dataset the `category' variable. it has very large
value names which quiet messy to do analysis so let's rename the values
without losing it's original meaning and making easier to interpret in
plots also

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dataset<-dataset }\OperatorTok{%>%}\StringTok{ }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{category=}\KeywordTok{recode}\NormalTok{(category, }
                                  \DataTypeTok{carbon_dioxide_co2_emissions_without_land_use_land_use_change_and_forestry_lulucf_in_kilotonne_co2_equivalent=}\StringTok{'CO2'}\NormalTok{,}
                                  \DataTypeTok{greenhouse_gas_ghgs_emissions_including_indirect_co2_without_lulucf_in_kilotonne_co2_equivalent=}\StringTok{'GHG_indirect_CO2'}\NormalTok{,}
                                  \DataTypeTok{greenhouse_gas_ghgs_emissions_without_land_use_land_use_change_and_forestry_lulucf_in_kilotonne_co2_equivalent=}\StringTok{'GHG'}\NormalTok{,}
                                  \DataTypeTok{hydrofluorocarbons_hfcs_emissions_in_kilotonne_co2_equivalent=}\StringTok{'HFC'}\NormalTok{,}
                                  \DataTypeTok{methane_ch4_emissions_without_land_use_land_use_change_and_forestry_lulucf_in_kilotonne_co2_equivalent=}\StringTok{'CH4'}\NormalTok{,}
                                  \DataTypeTok{nitrogen_trifluoride_nf3_emissions_in_kilotonne_co2_equivalent=}\StringTok{'HF3'}\NormalTok{,}
                                  \DataTypeTok{nitrous_oxide_n2o_emissions_without_land_use_land_use_change_and_forestry_lulucf_in_kilotonne_co2_equivalent=}\StringTok{'N2Os'}\NormalTok{,}
                                  \DataTypeTok{perfluorocarbons_pfcs_emissions_in_kilotonne_co2_equivalent=}\StringTok{'PFCs'}\NormalTok{,}
                                  \DataTypeTok{sulphur_hexafluoride_sf6_emissions_in_kilotonne_co2_equivalent=}\StringTok{'SF6'}\NormalTok{,}
                                  \DataTypeTok{unspecified_mix_of_hydrofluorocarbons_hfcs_and_perfluorocarbons_pfcs_emissions_in_kilotonne_co2_equivalent=}\StringTok{'HFC-PFC-mix'}\NormalTok{))}

\KeywordTok{head}\NormalTok{(dataset)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   country_or_area year       value category
## 1       Australia 2014  393126.947      CO2
## 2       Australia 2013 396913.9365      CO2
## 3       Australia 2012 406462.8477      CO2
## 4       Australia 2011 403705.5283      CO2
## 5       Australia 2010 406200.9932      CO2
## 6       Australia 2009  408448.479      CO2
\end{verbatim}

checking Number of countries that are contributing the gases emission

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{n_distinct}\NormalTok{(dataset}\OperatorTok{$}\NormalTok{country_or_area)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 44
\end{verbatim}

\#there are total 44 unique countries are there in the dataset

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#renaming the column 'country_or_area_ to 'country' for ease of use}

\NormalTok{dataset <-}\StringTok{ }\NormalTok{dataset }\OperatorTok{%>%}\StringTok{ }\KeywordTok{rename}\NormalTok{( }\DataTypeTok{country =}\NormalTok{ country_or_area)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#changing all the values in the country column to the lower case for ease of use}
\NormalTok{dataset}\OperatorTok{$}\NormalTok{country <-}\StringTok{ }\KeywordTok{tolower}\NormalTok{(dataset}\OperatorTok{$}\NormalTok{country)}

\CommentTok{#changing few longer country names to shorter form}
\NormalTok{dataset[dataset}\OperatorTok{$}\NormalTok{country}\OperatorTok{==}\StringTok{'russian federation'}\NormalTok{,}\StringTok{'country'}\NormalTok{] <-}\StringTok{'russia'}
\NormalTok{dataset[dataset}\OperatorTok{$}\NormalTok{country}\OperatorTok{==}\StringTok{'united kingdom'}\NormalTok{,}\StringTok{'country'}\NormalTok{] <-}\StringTok{'uk'}
\NormalTok{dataset[dataset}\OperatorTok{$}\NormalTok{country}\OperatorTok{==}\StringTok{'united states of america'}\NormalTok{,}\StringTok{'country'}\NormalTok{] <-}\StringTok{'usa'}

\KeywordTok{unique}\NormalTok{(dataset}\OperatorTok{$}\NormalTok{country)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] "australia"      "austria"        "belarus"        "belgium"       
##  [5] "bulgaria"       "canada"         "croatia"        "cyprus"        
##  [9] "czech republic" "denmark"        "estonia"        "european union"
## [13] "finland"        "france"         "germany"        "greece"        
## [17] "hungary"        "iceland"        "ireland"        "italy"         
## [21] "japan"          "latvia"         "liechtenstein"  "lithuania"     
## [25] "luxembourg"     "malta"          "monaco"         "netherlands"   
## [29] "new zealand"    "norway"         "poland"         "portugal"      
## [33] "romania"        "russia"         "slovakia"       "slovenia"      
## [37] "spain"          "sweden"         "switzerland"    "turkey"        
## [41] "ukraine"        "uk"             "usa"            "czechia"
\end{verbatim}

let's remove the value european union which is mix of countries, we are
alanysing country wise so it's better to remove and keep it in a single
layer level analysis.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dataset <-}\StringTok{ }\NormalTok{dataset }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(country}\OperatorTok{!=}\StringTok{'european union'}\NormalTok{)}
\KeywordTok{unique}\NormalTok{(dataset}\OperatorTok{$}\NormalTok{country)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] "australia"      "austria"        "belarus"        "belgium"       
##  [5] "bulgaria"       "canada"         "croatia"        "cyprus"        
##  [9] "czech republic" "denmark"        "estonia"        "finland"       
## [13] "france"         "germany"        "greece"         "hungary"       
## [17] "iceland"        "ireland"        "italy"          "japan"         
## [21] "latvia"         "liechtenstein"  "lithuania"      "luxembourg"    
## [25] "malta"          "monaco"         "netherlands"    "new zealand"   
## [29] "norway"         "poland"         "portugal"       "romania"       
## [33] "russia"         "slovakia"       "slovenia"       "spain"         
## [37] "sweden"         "switzerland"    "turkey"         "ukraine"       
## [41] "uk"             "usa"            "czechia"
\end{verbatim}

finally let's change the value column to numeric for the analysis

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#while converting data from char to numeric we might get NA values because some of our input values are not formatted properly, because they contain commas (i.e. ,) between the numbers. We can remove these commas by using the gsub function.}
\NormalTok{dataset}\OperatorTok{$}\NormalTok{value <-}\StringTok{ }\KeywordTok{gsub}\NormalTok{(}\StringTok{","}\NormalTok{,}\StringTok{""}\NormalTok{,dataset}\OperatorTok{$}\NormalTok{value)}
\NormalTok{dataset}\OperatorTok{$}\NormalTok{value <-}\StringTok{ }\KeywordTok{as.numeric}\NormalTok{(dataset}\OperatorTok{$}\NormalTok{value)}
\KeywordTok{str}\NormalTok{(dataset)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 'data.frame':    9398 obs. of  4 variables:
##  $ country : chr  "australia" "australia" "australia" "australia" ...
##  $ year    : int  2014 2013 2012 2011 2010 2009 2008 2007 2006 2005 ...
##  $ value   : num  393127 396914 406463 403706 406201 ...
##  $ category: chr  "CO2" "CO2" "CO2" "CO2" ...
\end{verbatim}

\textbf{3.Data analysis}

let's find out the total emission per gas that has been released in the
total years from 1990 to 2018

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{total_emissions <-}\StringTok{ }\NormalTok{dataset }\OperatorTok{%>%}\StringTok{ }\KeywordTok{group_by}\NormalTok{(category) }\OperatorTok{%>%}\KeywordTok{summarise}\NormalTok{(}\KeywordTok{sum}\NormalTok{(value))}
\CommentTok{#arrange the data in descending order }
\KeywordTok{colnames}\NormalTok{(total_emissions)[}\DecValTok{2}\NormalTok{] <-}\StringTok{ "total_value"}\CommentTok{#changing name of column}
\NormalTok{total_emissions <-}\StringTok{ }\NormalTok{total_emissions }\OperatorTok{%>%}\StringTok{ }\KeywordTok{arrange}\NormalTok{(}\KeywordTok{desc}\NormalTok{(}\StringTok{`}\DataTypeTok{total_value}\StringTok{`}\NormalTok{))}\CommentTok{#ordering the data in descending order}
\NormalTok{total_emissions}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 10 x 2
##    category         total_value
##    <chr>                  <dbl>
##  1 GHG               524444808.
##  2 GHG_indirect_CO2  437114066.
##  3 CO2               414828411.
##  4 CH4                71608587.
##  5 N2Os               28275799.
##  6 HFC                 7084020.
##  7 PFCs                1301123.
##  8 SF6                 1068301.
##  9 HFC-PFC-mix          248136.
## 10 HF3                   30432.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggplot}\NormalTok{(total_emissions, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\KeywordTok{reorder}\NormalTok{(category,}\OperatorTok{-}\NormalTok{total_value), }\DataTypeTok{y=}\NormalTok{total_value)) }\OperatorTok{+}
\StringTok{    }\KeywordTok{geom_bar}\NormalTok{(}\DataTypeTok{stat=}\StringTok{"identity"}\NormalTok{, }\DataTypeTok{fill=}\StringTok{"red"}\NormalTok{, }\DataTypeTok{alpha=}\NormalTok{.}\DecValTok{8}\NormalTok{, }\DataTypeTok{width=}\NormalTok{.}\DecValTok{4}\NormalTok{) }\OperatorTok{+}
\StringTok{    }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Gas type"}\NormalTok{) }\OperatorTok{+}
\StringTok{    }\KeywordTok{ylab}\NormalTok{(}\StringTok{"In kilotons equivalent (log10)"}\NormalTok{)}\OperatorTok{+}
\StringTok{    }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Total emissions by each gas from 1990-2018"}\NormalTok{)}\OperatorTok{+}
\StringTok{    }\KeywordTok{theme_bw}\NormalTok{()}\OperatorTok{+}
\StringTok{  }\KeywordTok{coord_flip}\NormalTok{(}\DataTypeTok{expand =} \OtherTok{TRUE}\NormalTok{)}\CommentTok{#rotate the axis to avoid data overlapping}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Project_gollu_files/figure-latex/unnamed-chunk-11-1.pdf}
As in the above plot it's clearly showing that ``GHG'' is the highest
emission around the world, followed by ``GHG\_indirect\_CO2'' as second
highest and next order is in ``CO2'', ``CH4'' and ``N2Os''. These are
the top five emissions from the year 1990 -2018 around the world.

\#now let's look at the total contribution of all gases over the years.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#group the data by category and year}
\NormalTok{Total_contribution_per_year <-}\StringTok{ }\NormalTok{dataset }\OperatorTok{%>%}\StringTok{ }\KeywordTok{group_by}\NormalTok{(category,year) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{summarize}\NormalTok{(}\DataTypeTok{total_value =} \KeywordTok{sum}\NormalTok{(value),}\DataTypeTok{.groups =} \StringTok{'drop'}\NormalTok{)}
\CommentTok{#now visualizing the grouped data }
\KeywordTok{ggplot}\NormalTok{(Total_contribution_per_year, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\KeywordTok{factor}\NormalTok{(year),}\DataTypeTok{y=}\NormalTok{total_value,}\DataTypeTok{group=}\NormalTok{category)) }\OperatorTok{+}\StringTok{ }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{color=}\NormalTok{category),}\DataTypeTok{size=}\FloatTok{1.2}\NormalTok{) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{size=}\NormalTok{.}\DecValTok{7}\NormalTok{,}\DataTypeTok{color=}\StringTok{'black'}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_color_brewer}\NormalTok{(}\DataTypeTok{name=}\StringTok{''}\NormalTok{,}\DataTypeTok{palette=}\StringTok{'Paired'}\NormalTok{) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{legend.position=}\StringTok{'top'}\NormalTok{) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{axis.text.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{size=}\DecValTok{9}\NormalTok{,}\DataTypeTok{angle=}\DecValTok{45}\NormalTok{),}
        \DataTypeTok{legend.text=}\KeywordTok{element_text}\NormalTok{(}\DataTypeTok{size=}\DecValTok{9}\NormalTok{)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{title=}\StringTok{'International Greenhouse gas emissions'}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{guides}\NormalTok{(}\DataTypeTok{color=}\KeywordTok{guide_legend}\NormalTok{(}\DataTypeTok{ncol=}\DecValTok{3}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Project_gollu_files/figure-latex/unnamed-chunk-12-1.pdf}
by looking at the above graph, `GHG',`GHG\_indirect\_CO2' and `CO2' are
the most emissioned gas over the past years and there is a substantial
drop of `'GHG\_indirect\_gas' from the year 2015 to 2018 and few gases
have a little amount of ups and downs from where they started but they
continued on the same level so far.

\#let's visualize which countries caused highest emissions per each gas
and for deeper analysis,let's visualise the top 4 gases that are
produced by entire world over the years. \textbf{the top 4 are} 1.GHG
2.GHG\_indirect\_CO2 3.CO2 4.CH4

\hypertarget{analysis-of-ghg-gas-emission}{%
\section{1. Analysis of ``GHG'' gas
emission}\label{analysis-of-ghg-gas-emission}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#selecting a subset of data that only contains "GHG" gas emission}
\NormalTok{GHG_data <-}\StringTok{ }\NormalTok{dataset[dataset}\OperatorTok{$}\NormalTok{category}\OperatorTok{==}\StringTok{'GHG'}\NormalTok{,]}
\CommentTok{#grouping by each country to know which countries produced highest GHG}
\NormalTok{GHG_by_country <-}\StringTok{ }\NormalTok{GHG_data}\OperatorTok{%>%}\StringTok{ }\KeywordTok{group_by}\NormalTok{(country) }\OperatorTok{%>%}\KeywordTok{summarise}\NormalTok{(}\KeywordTok{sum}\NormalTok{(value))}
\KeywordTok{colnames}\NormalTok{(GHG_by_country)[}\DecValTok{2}\NormalTok{] <-}\StringTok{ "total_value"}\CommentTok{#changing name of column}
\NormalTok{GHG_by_country <-}\StringTok{ }\NormalTok{GHG_by_country }\OperatorTok{%>%}\StringTok{ }\KeywordTok{arrange}\NormalTok{(}\KeywordTok{desc}\NormalTok{(total_value))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggplot}\NormalTok{(GHG_by_country, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=} \KeywordTok{reorder}\NormalTok{(country, }\OperatorTok{-}\NormalTok{total_value), }\DataTypeTok{y=}\NormalTok{total_value)) }\OperatorTok{+}
\StringTok{    }\KeywordTok{geom_bar}\NormalTok{(}\DataTypeTok{stat=}\StringTok{"identity"}\NormalTok{, }\DataTypeTok{fill=}\StringTok{"maroon2"}\NormalTok{, }\DataTypeTok{alpha=}\DecValTok{1}\NormalTok{, }\DataTypeTok{width=}\NormalTok{.}\DecValTok{4}\NormalTok{) }\OperatorTok{+}
\StringTok{    }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Country"}\NormalTok{) }\OperatorTok{+}
\StringTok{    }\KeywordTok{ylab}\NormalTok{(}\StringTok{"Value"}\NormalTok{)}\OperatorTok{+}
\StringTok{    }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Total emission of 'GHG' by each country from 1990-2018"}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{coord_flip}\NormalTok{(}\DataTypeTok{expand =} \OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Project_gollu_files/figure-latex/unnamed-chunk-14-1.pdf}
countries-- usa,russia,japan,germany, canada ,uk and france are at top
and all of these combine contributing a major chunk of `GHG' emission.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pie <-}\StringTok{ }\KeywordTok{ggplot}\NormalTok{(GHG_by_country,}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\StringTok{""}\NormalTok{,}\DataTypeTok{y=}\NormalTok{total_value,}\DataTypeTok{fill =}\NormalTok{ country))}\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_bar}\NormalTok{(}\DataTypeTok{stat =} \StringTok{"identity"}\NormalTok{,}\DataTypeTok{colour=}\StringTok{"gray"}\NormalTok{)}
\NormalTok{pie}\OperatorTok{+}\KeywordTok{coord_polar}\NormalTok{(}\StringTok{"y"}\NormalTok{, }\DataTypeTok{start=}\DecValTok{0}\NormalTok{,}\DataTypeTok{direction =} \DecValTok{1}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Total 'GHG' emission by Country"}\NormalTok{,}\DataTypeTok{subtitle =} \StringTok{"from the year 1990 -2018"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Project_gollu_files/figure-latex/unnamed-chunk-15-1.pdf}

\hypertarget{analysis-of-ghg_indirect_co2-gas-emission}{%
\section{2. Analysis of ``GHG\_indirect\_CO2'' gas
emission}\label{analysis-of-ghg_indirect_co2-gas-emission}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#selecting a subset of data that only contains "GHG" gas emission}
\NormalTok{GHG_indirect_CO2 <-}\StringTok{ }\NormalTok{dataset[dataset}\OperatorTok{$}\NormalTok{category}\OperatorTok{==}\StringTok{'GHG_indirect_CO2'}\NormalTok{,]}
\CommentTok{#grouping by each country to know which countries produced highest GHG}
\NormalTok{GHG_indirect_country <-}\StringTok{ }\NormalTok{GHG_indirect_CO2}\OperatorTok{%>%}\StringTok{ }\KeywordTok{group_by}\NormalTok{(country) }\OperatorTok{%>%}\KeywordTok{summarise}\NormalTok{(}\DataTypeTok{total_value =} \KeywordTok{sum}\NormalTok{(value),}\DataTypeTok{.groups =} \StringTok{'drop'}\NormalTok{)}
\NormalTok{GHG_indirect_country <-}\StringTok{ }\NormalTok{GHG_indirect_country }\OperatorTok{%>%}\StringTok{ }\KeywordTok{arrange}\NormalTok{(}\KeywordTok{desc}\NormalTok{(total_value))}

\CommentTok{#visualising the GHG_indirect_CO2}
\KeywordTok{ggplot}\NormalTok{(GHG_indirect_country, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=} \KeywordTok{reorder}\NormalTok{(country, }\OperatorTok{-}\NormalTok{total_value), }\DataTypeTok{y=}\NormalTok{total_value)) }\OperatorTok{+}
\StringTok{    }\KeywordTok{geom_bar}\NormalTok{(}\DataTypeTok{stat=}\StringTok{"identity"}\NormalTok{, }\DataTypeTok{fill=}\StringTok{"blue"}\NormalTok{, }\DataTypeTok{alpha=}\DecValTok{1}\NormalTok{, }\DataTypeTok{width=}\NormalTok{.}\DecValTok{4}\NormalTok{) }\OperatorTok{+}
\StringTok{    }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Country"}\NormalTok{) }\OperatorTok{+}
\StringTok{    }\KeywordTok{ylab}\NormalTok{(}\StringTok{"Value"}\NormalTok{)}\OperatorTok{+}
\StringTok{    }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Total emission of 'GHG_indirect_CO2' by each country from 1990-2018"}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{coord_flip}\NormalTok{(}\DataTypeTok{expand =} \OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Project_gollu_files/figure-latex/unnamed-chunk-16-1.pdf}

countries-- usa,russia,japan,germany, canada,france and italy are at top
and all of these combine contributing a major chunk of
`GHG\_indirect\_CO2' emission.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pie <-}\StringTok{ }\KeywordTok{ggplot}\NormalTok{(GHG_indirect_country,}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\StringTok{""}\NormalTok{,}\DataTypeTok{y=}\NormalTok{total_value,}\DataTypeTok{fill =}\NormalTok{ country))}\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_bar}\NormalTok{(}\DataTypeTok{stat =} \StringTok{"identity"}\NormalTok{,}\DataTypeTok{colour=}\StringTok{"gray"}\NormalTok{)}
\NormalTok{pie}\OperatorTok{+}\KeywordTok{coord_polar}\NormalTok{(}\StringTok{"y"}\NormalTok{, }\DataTypeTok{start=}\DecValTok{0}\NormalTok{,}\DataTypeTok{direction =} \DecValTok{1}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Total 'GHG_indirect_CO2' by Country"}\NormalTok{,}\DataTypeTok{subtitle =} \StringTok{"from the year 1990 -2018"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Project_gollu_files/figure-latex/unnamed-chunk-17-1.pdf}

\textbf{3.Analysis of CO2 emission}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#selecting a subset of data that only contains "CO2" gas emission}
\NormalTok{CO2_data <-}\StringTok{ }\NormalTok{dataset[dataset}\OperatorTok{$}\NormalTok{category}\OperatorTok{==}\StringTok{'CO2'}\NormalTok{,]}
\CommentTok{#grouping by each country to know which countries produced highest GHG}
\NormalTok{CO2_by_country <-}\StringTok{ }\NormalTok{CO2_data}\OperatorTok{%>%}\StringTok{ }\KeywordTok{group_by}\NormalTok{(country) }\OperatorTok{%>%}\KeywordTok{summarise}\NormalTok{(}\DataTypeTok{total_value =} \KeywordTok{sum}\NormalTok{(value),}\DataTypeTok{.groups =} \StringTok{'drop'}\NormalTok{)}
\NormalTok{CO2_by_country <-}\StringTok{ }\NormalTok{CO2_by_country }\OperatorTok{%>%}\StringTok{ }\KeywordTok{arrange}\NormalTok{(}\KeywordTok{desc}\NormalTok{(total_value))}

\CommentTok{#visualising the GHG_indirect_CO2}
\KeywordTok{ggplot}\NormalTok{(CO2_by_country, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=} \KeywordTok{reorder}\NormalTok{(country, }\OperatorTok{-}\NormalTok{total_value), }\DataTypeTok{y=}\NormalTok{total_value)) }\OperatorTok{+}
\StringTok{    }\KeywordTok{geom_bar}\NormalTok{(}\DataTypeTok{stat=}\StringTok{"identity"}\NormalTok{, }\DataTypeTok{fill=}\StringTok{"darkgreen"}\NormalTok{, }\DataTypeTok{alpha=}\DecValTok{1}\NormalTok{, }\DataTypeTok{width=}\NormalTok{.}\DecValTok{4}\NormalTok{) }\OperatorTok{+}
\StringTok{    }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Country"}\NormalTok{) }\OperatorTok{+}
\StringTok{    }\KeywordTok{ylab}\NormalTok{(}\StringTok{"Value"}\NormalTok{)}\OperatorTok{+}
\StringTok{    }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Total emission of 'CO2' by each country from 1990-2018"}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{coord_flip}\NormalTok{(}\DataTypeTok{expand =} \OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Project_gollu_files/figure-latex/unnamed-chunk-18-1.pdf}
the Top `CO2' emission countries are =
usa,russia,japan,germany,canada,uk and italy

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pie <-}\StringTok{ }\KeywordTok{ggplot}\NormalTok{(CO2_by_country,}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\StringTok{""}\NormalTok{,}\DataTypeTok{y=}\NormalTok{total_value,}\DataTypeTok{fill =}\NormalTok{ country))}\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_bar}\NormalTok{(}\DataTypeTok{stat =} \StringTok{"identity"}\NormalTok{,}\DataTypeTok{colour=}\StringTok{"gray"}\NormalTok{)}
\NormalTok{pie}\OperatorTok{+}\KeywordTok{coord_polar}\NormalTok{(}\StringTok{"y"}\NormalTok{, }\DataTypeTok{start=}\DecValTok{0}\NormalTok{,}\DataTypeTok{direction =} \DecValTok{1}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Total 'CO2' by Country"}\NormalTok{,}\DataTypeTok{subtitle =} \StringTok{"from the year 1990 -2018"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Project_gollu_files/figure-latex/unnamed-chunk-19-1.pdf}
\textbf{analysis of `CH4'}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#selecting a subset of data that only contains "CO2" gas emission}
\NormalTok{CH4_data <-}\StringTok{ }\NormalTok{dataset[dataset}\OperatorTok{$}\NormalTok{category}\OperatorTok{==}\StringTok{'CH4'}\NormalTok{,]}
\CommentTok{#grouping by each country to know which countries produced highest GHG}
\NormalTok{CH4_by_country <-}\StringTok{ }\NormalTok{CH4_data}\OperatorTok{%>%}\StringTok{ }\KeywordTok{group_by}\NormalTok{(country) }\OperatorTok{%>%}\KeywordTok{summarise}\NormalTok{(}\DataTypeTok{total_value =} \KeywordTok{sum}\NormalTok{(value),}\DataTypeTok{.groups =} \StringTok{'drop'}\NormalTok{)}
\NormalTok{CH4_by_country <-}\StringTok{ }\NormalTok{CH4_by_country }\OperatorTok{%>%}\StringTok{ }\KeywordTok{arrange}\NormalTok{(}\KeywordTok{desc}\NormalTok{(total_value))}

\CommentTok{#visualising the GHG_indirect_CO2}
\KeywordTok{ggplot}\NormalTok{(CH4_by_country, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=} \KeywordTok{reorder}\NormalTok{(country, }\OperatorTok{-}\NormalTok{total_value), }\DataTypeTok{y=}\NormalTok{total_value)) }\OperatorTok{+}
\StringTok{    }\KeywordTok{geom_bar}\NormalTok{(}\DataTypeTok{stat=}\StringTok{"identity"}\NormalTok{, }\DataTypeTok{fill=}\StringTok{"cyan4"}\NormalTok{, }\DataTypeTok{alpha=}\DecValTok{1}\NormalTok{, }\DataTypeTok{width=}\NormalTok{.}\DecValTok{4}\NormalTok{) }\OperatorTok{+}
\StringTok{    }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Country"}\NormalTok{) }\OperatorTok{+}
\StringTok{    }\KeywordTok{ylab}\NormalTok{(}\StringTok{"Value"}\NormalTok{)}\OperatorTok{+}
\StringTok{    }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Total emission of 'CH4' by each country from 1990-2018"}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{coord_flip}\NormalTok{(}\DataTypeTok{expand =} \OtherTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Project_gollu_files/figure-latex/unnamed-chunk-20-1.pdf}
the Top `CH4' emission countries are =
usa,russia,ukraine,canada,australia,uk and germany

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pie <-}\StringTok{ }\KeywordTok{ggplot}\NormalTok{(CH4_by_country,}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\StringTok{""}\NormalTok{,}\DataTypeTok{y=}\NormalTok{total_value,}\DataTypeTok{fill =}\NormalTok{ country))}\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_bar}\NormalTok{(}\DataTypeTok{stat =} \StringTok{"identity"}\NormalTok{,}\DataTypeTok{colour=}\StringTok{"gray"}\NormalTok{)}
\NormalTok{pie}\OperatorTok{+}\KeywordTok{coord_polar}\NormalTok{(}\StringTok{"y"}\NormalTok{, }\DataTypeTok{start=}\DecValTok{0}\NormalTok{,}\DataTypeTok{direction =} \DecValTok{1}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Total 'CH4' by Country"}\NormalTok{,}\DataTypeTok{subtitle =} \StringTok{"from the year 1990 -2018"}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{(}\StringTok{"In kilotons equivalent"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Project_gollu_files/figure-latex/unnamed-chunk-21-1.pdf}
let's look at the top countries for the top 4 emissioned gases.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#subset the top seven 7 countries for each of high emissioned gas}
\NormalTok{category <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{'ghg'}\NormalTok{,}\StringTok{'ghg'}\NormalTok{,}\StringTok{'ghg'}\NormalTok{,}\StringTok{'ghg'}\NormalTok{,}\StringTok{'ghg'}\NormalTok{,}\StringTok{'ghg'}\NormalTok{,}\StringTok{'ghg'}\NormalTok{)}
\NormalTok{GHG_top_countries <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(GHG_by_country[}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\DecValTok{7}\NormalTok{),],category)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#adding a new column for each type of gas }
\NormalTok{category <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{'ghg_indirect_co2'}\NormalTok{,}\StringTok{'ghg_indirect_co2'}\NormalTok{,}\StringTok{'ghg_indirect_co2'}\NormalTok{,}\StringTok{'ghg_indirect_co2'}\NormalTok{,}\StringTok{'ghg_indirect_co2'}\NormalTok{,}\StringTok{'ghg_indirect_co2'}\NormalTok{,}\StringTok{'ghg_indirect_co2'}\NormalTok{)}
\NormalTok{GHG_indirect_top <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(GHG_indirect_country[}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\DecValTok{7}\NormalTok{),],category)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#adding a new column for each type of gas }
\NormalTok{category <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{'co2'}\NormalTok{,}\StringTok{'co2'}\NormalTok{,}\StringTok{'co2'}\NormalTok{,}\StringTok{'co2'}\NormalTok{,}\StringTok{'co2'}\NormalTok{,}\StringTok{'co2'}\NormalTok{,}\StringTok{'co2'}\NormalTok{)}
\NormalTok{CO2_top_countries <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(CO2_by_country[}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\DecValTok{7}\NormalTok{),],category)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#adding a new column for each type of gas }
\NormalTok{category <-}\KeywordTok{c}\NormalTok{(}\StringTok{'ch4'}\NormalTok{,}\StringTok{'ch4'}\NormalTok{,}\StringTok{'ch4'}\NormalTok{,}\StringTok{'ch4'}\NormalTok{,}\StringTok{'ch4'}\NormalTok{,}\StringTok{'ch4'}\NormalTok{,}\StringTok{'ch4'}\NormalTok{)}
\NormalTok{CH4_top_countries <-}\KeywordTok{data.frame}\NormalTok{(CH4_by_country[}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\DecValTok{7}\NormalTok{),],category)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#using rbind we can combine all the data and make it visualize clearly}
\NormalTok{total_top_countries <-}\StringTok{ }\KeywordTok{rbind}\NormalTok{(GHG_top_countries,GHG_indirect_top,CO2_top_countries,CH4_top_countries)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#plotting all the top gases and country's each contribution}
\NormalTok{col_chart<-}\StringTok{ }\KeywordTok{ggplot}\NormalTok{(}\DataTypeTok{data =}\NormalTok{ total_top_countries)}\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_col}\NormalTok{(}\DataTypeTok{mapping =} \KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \KeywordTok{reorder}\NormalTok{(country, }\OperatorTok{-}\NormalTok{total_value), }\DataTypeTok{y =}\NormalTok{ total_value, }\DataTypeTok{fill =}\NormalTok{ category))}\OperatorTok{+}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{axis.text.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{size=}\DecValTok{10}\NormalTok{),}
        \DataTypeTok{legend.text=}\KeywordTok{element_text}\NormalTok{(}\DataTypeTok{size=}\DecValTok{10}\NormalTok{))}\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Country"}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{(}\StringTok{"In kilotons equivalent"}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Combine highest gas producing countries"}\NormalTok{)}
\NormalTok{col_chart}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Project_gollu_files/figure-latex/unnamed-chunk-27-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#changing the bars to individual}
\KeywordTok{ggplot}\NormalTok{(}\DataTypeTok{data =}\NormalTok{ total_top_countries)}\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_col}\NormalTok{(}\DataTypeTok{mapping =} \KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \KeywordTok{reorder}\NormalTok{(country, }\OperatorTok{-}\NormalTok{total_value), }\DataTypeTok{y =}\NormalTok{ total_value, }\DataTypeTok{fill =}\NormalTok{ category),}\DataTypeTok{position =} \StringTok{"dodge"}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Country"}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{(}\StringTok{"In kilotons equivalent"}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"Combine highest gas producing countries"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Project_gollu_files/figure-latex/unnamed-chunk-28-1.pdf}

from above plot we can clearly see that countries
``USA'',``Russia'',``Japan'' and ``Germany'' contributing a high portion
of these gases and keeping these observations in mind now let's look at
these four countries individual gas emissions over the years.

\textbf{USA emissions from 1990 to 2018}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#analysis of USA country emissions }
\NormalTok{usa_emissions <-}\StringTok{ }\NormalTok{dataset[dataset}\OperatorTok{$}\NormalTok{country}\OperatorTok{==}\StringTok{'usa'}\NormalTok{,] }\CommentTok{#selecting data for a single country}
\NormalTok{usa_emissions }\OperatorTok{%>%}\StringTok{ }\KeywordTok{group_by}\NormalTok{(category, year) }\OperatorTok{%>%}\StringTok{ }\CommentTok{#grouping category and year together}
\StringTok{  }\KeywordTok{summarise}\NormalTok{(}\DataTypeTok{total_value=}\KeywordTok{sum}\NormalTok{(value),}\DataTypeTok{.groups =} \StringTok{'drop'}\NormalTok{)}\OperatorTok{%>%}
\StringTok{  }\KeywordTok{ggplot}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\NormalTok{year,}\DataTypeTok{y=}\NormalTok{total_value, }\DataTypeTok{col=}\NormalTok{category ))}\OperatorTok{+}\CommentTok{#plotting a line plot}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\DataTypeTok{na.rm=}\OtherTok{TRUE}\NormalTok{, }\DataTypeTok{size=}\DecValTok{1}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{size=}\NormalTok{.}\DecValTok{5}\NormalTok{,}\DataTypeTok{alpha =} \FloatTok{.5}\NormalTok{,}\DataTypeTok{color =} \StringTok{"black"}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_color_brewer}\NormalTok{(}\DataTypeTok{name=}\StringTok{''}\NormalTok{,}\DataTypeTok{palette=}\StringTok{'Paired'}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{theme_minimal}\NormalTok{()}\OperatorTok{+}
\StringTok{  }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{title=}\StringTok{'USA Gas Emissions'}\NormalTok{,}
       \DataTypeTok{subtitle=} \StringTok{'in kilotons , from 1990-2018'}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{'year'}\NormalTok{)}\OperatorTok{+}\KeywordTok{ylab}\NormalTok{(}\StringTok{''}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Project_gollu_files/figure-latex/unnamed-chunk-30-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#visualizing bar plot to know the portion of each emission gases and compare with each other}
\NormalTok{ usa_emissions }\OperatorTok{%>%}\StringTok{ }\KeywordTok{group_by}\NormalTok{(category, year) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{summarise}\NormalTok{(}\DataTypeTok{total_value=}\KeywordTok{sum}\NormalTok{(value),}\DataTypeTok{.groups =} \StringTok{'drop'}\NormalTok{)}\OperatorTok{%>%}
\StringTok{  }\KeywordTok{ggplot}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\NormalTok{category, }\DataTypeTok{y=}\NormalTok{total_value,}\DataTypeTok{fill =}\NormalTok{ category))}\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_col}\NormalTok{(}\DataTypeTok{width =} \FloatTok{.6}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{axis.text.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{size=}\DecValTok{10}\NormalTok{))}\OperatorTok{+}\CommentTok{#increasing the length of x axis text}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Category"}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{(}\StringTok{"In kilotons equivalent"}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{title=}\StringTok{'USA Gas Emissions'}\NormalTok{,}
       \DataTypeTok{subtitle=} \StringTok{'in kilotons , from 1990-2018'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Project_gollu_files/figure-latex/unnamed-chunk-32-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#lets find out the % of emission of each USA gases from 1990 to 2018}
\NormalTok{usa_gas_wise_total <-}\StringTok{ }\NormalTok{usa_emissions}\OperatorTok{%>%}\StringTok{ }\KeywordTok{group_by}\NormalTok{(category) }\OperatorTok{%>%}\KeywordTok{summarise}\NormalTok{(}\DataTypeTok{total_value =} \KeywordTok{sum}\NormalTok{(value),}\DataTypeTok{.groups =} \StringTok{'drop'}\NormalTok{)}
\CommentTok{#find the sum of total country gas emission}
\NormalTok{usa_sum <-}\StringTok{ }\KeywordTok{sum}\NormalTok{(usa_gas_wise_total}\OperatorTok{$}\NormalTok{total_value)}
\CommentTok{#create a column name 'emission_percentage and calculate the % of contribution'}
\NormalTok{usa_percentage <-}\StringTok{ }\KeywordTok{mutate}\NormalTok{(usa_gas_wise_total, }\DataTypeTok{usa_emission_percentage =}\NormalTok{ (usa_gas_wise_total}\OperatorTok{$}\NormalTok{total_value}\OperatorTok{/}\NormalTok{usa_sum)}\OperatorTok{*}\DecValTok{100}\NormalTok{)}\OperatorTok{%>%}\StringTok{ }\KeywordTok{mutate_at}\NormalTok{(}\KeywordTok{vars}\NormalTok{(usa_emission_percentage), }\KeywordTok{funs}\NormalTok{(}\KeywordTok{round}\NormalTok{(., }\DecValTok{2}\NormalTok{)))}
\NormalTok{usa_percentage}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 10 x 3
##    category         total_value usa_emission_percentage
##  * <chr>                  <dbl>                   <dbl>
##  1 CH4                20922010.                    3.65
##  2 CO2               162992307.                   28.4 
##  3 GHG               200068613.                   34.9 
##  4 GHG_indirect_CO2  173703277.                   30.3 
##  5 HF3                   11054.                    0   
##  6 HFC                 3220566.                    0.56
##  7 HFC-PFC-mix          181693.                    0.03
##  8 N2Os               11949725.                    2.08
##  9 PFCs                 320123.                    0.06
## 10 SF6                  471137.                    0.08
\end{verbatim}

\textbf{Russia emissions from 1990 to 2018}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#analysis of Russia country emissions }
\NormalTok{russia_emissions <-}\StringTok{ }\NormalTok{dataset[dataset}\OperatorTok{$}\NormalTok{country}\OperatorTok{==}\StringTok{'russia'}\NormalTok{,] }\CommentTok{#selecting data for a single country}
\NormalTok{russia_emissions }\OperatorTok{%>%}\StringTok{ }\KeywordTok{group_by}\NormalTok{(category, year) }\OperatorTok{%>%}\StringTok{ }\CommentTok{#grouping category and year together}
\StringTok{  }\KeywordTok{summarise}\NormalTok{(}\DataTypeTok{total_value=}\KeywordTok{sum}\NormalTok{(value),}\DataTypeTok{.groups =} \StringTok{'drop'}\NormalTok{)}\OperatorTok{%>%}
\StringTok{  }\KeywordTok{ggplot}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\NormalTok{year,}\DataTypeTok{y=}\NormalTok{total_value, }\DataTypeTok{col=}\NormalTok{category ))}\OperatorTok{+}\CommentTok{#plotting a line plot}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\DataTypeTok{na.rm=}\OtherTok{TRUE}\NormalTok{, }\DataTypeTok{size=}\DecValTok{1}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{size=}\NormalTok{.}\DecValTok{5}\NormalTok{,}\DataTypeTok{alpha =} \FloatTok{.5}\NormalTok{,}\DataTypeTok{color =} \StringTok{"black"}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_color_brewer}\NormalTok{(}\DataTypeTok{name=}\StringTok{''}\NormalTok{,}\DataTypeTok{palette=}\StringTok{'Paired'}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{theme_minimal}\NormalTok{()}\OperatorTok{+}
\StringTok{  }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{title=}\StringTok{'Russia Gas Emissions'}\NormalTok{,}
       \DataTypeTok{subtitle=} \StringTok{'in kilotons , from 1990-2018'}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{'year'}\NormalTok{)}\OperatorTok{+}\KeywordTok{ylab}\NormalTok{(}\StringTok{''}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Project_gollu_files/figure-latex/unnamed-chunk-34-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#visualizing bar plot to know the portion of each emission gases and compare with each other}
\NormalTok{ russia_emissions }\OperatorTok{%>%}\StringTok{ }\KeywordTok{group_by}\NormalTok{(category, year) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{summarise}\NormalTok{(}\DataTypeTok{total_value=}\KeywordTok{sum}\NormalTok{(value),}\DataTypeTok{.groups =} \StringTok{'drop'}\NormalTok{)}\OperatorTok{%>%}
\StringTok{  }\KeywordTok{ggplot}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\NormalTok{category, }\DataTypeTok{y=}\NormalTok{total_value,}\DataTypeTok{fill =}\NormalTok{ category))}\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_col}\NormalTok{(}\DataTypeTok{width =} \FloatTok{.6}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{axis.text.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{size=}\DecValTok{10}\NormalTok{))}\OperatorTok{+}\CommentTok{#increasing the length of x axis text}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Category"}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{(}\StringTok{"In kilotons equivalent"}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{title=}\StringTok{'Russia Gas Emissions'}\NormalTok{,}
       \DataTypeTok{subtitle=} \StringTok{'in kilotons , from 1990-2018'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Project_gollu_files/figure-latex/unnamed-chunk-35-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#lets find out the % of emission of each Russia gases from 1990 to 2018}
\NormalTok{russia_gas_wise_total <-}\StringTok{ }\NormalTok{russia_emissions}\OperatorTok{%>%}\StringTok{ }\KeywordTok{group_by}\NormalTok{(category) }\OperatorTok{%>%}\KeywordTok{summarise}\NormalTok{(}\DataTypeTok{total_value =} \KeywordTok{sum}\NormalTok{(value),}\DataTypeTok{.groups =} \StringTok{'drop'}\NormalTok{)}
\CommentTok{#find the sum of total country gas emission}
\NormalTok{russia_sum <-}\StringTok{ }\KeywordTok{sum}\NormalTok{(russia_gas_wise_total}\OperatorTok{$}\NormalTok{total_value)}
\CommentTok{#create a column name 'emission_percentage and calculate the % of contribution'}
\NormalTok{russia_percentage <-}\StringTok{ }\KeywordTok{mutate}\NormalTok{(russia_gas_wise_total, }\DataTypeTok{russia_emission_percentage =}\NormalTok{ (russia_gas_wise_total}\OperatorTok{$}\NormalTok{total_value}\OperatorTok{/}\NormalTok{russia_sum)}\OperatorTok{*}\DecValTok{100}\NormalTok{)}\OperatorTok{%>%}\StringTok{ }\KeywordTok{mutate_at}\NormalTok{(}\KeywordTok{vars}\NormalTok{(russia_emission_percentage), }\KeywordTok{funs}\NormalTok{(}\KeywordTok{round}\NormalTok{(., }\DecValTok{2}\NormalTok{)))}
\NormalTok{russia_percentage}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 9 x 3
##   category         total_value russia_emission_percentage
## * <chr>                  <dbl>                      <dbl>
## 1 CH4                20462518.                      9.64 
## 2 CO2                49241132.                     23.2  
## 3 GHG                73594670.                     34.7  
## 4 GHG_indirect_CO2   65027127.                     30.6  
## 5 HF3                       9                       0    
## 6 HFC                  624129.                      0.290
## 7 N2Os                3009207.                      1.42 
## 8 PFCs                 224047.                      0.11 
## 9 SF6                   33627.                      0.02
\end{verbatim}

\textbf{Japan emissions from 1990 to 2018}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#analysis of Japan country emissions }
\NormalTok{japan_emissions <-}\StringTok{ }\NormalTok{dataset[dataset}\OperatorTok{$}\NormalTok{country}\OperatorTok{==}\StringTok{'japan'}\NormalTok{,] }\CommentTok{#selecting data for a single country}
\NormalTok{japan_emissions }\OperatorTok{%>%}\StringTok{ }\KeywordTok{group_by}\NormalTok{(category, year) }\OperatorTok{%>%}\StringTok{ }\CommentTok{#grouping category and year together}
\StringTok{  }\KeywordTok{summarise}\NormalTok{(}\DataTypeTok{total_value=}\KeywordTok{sum}\NormalTok{(value),}\DataTypeTok{.groups =} \StringTok{'drop'}\NormalTok{)}\OperatorTok{%>%}
\StringTok{  }\KeywordTok{ggplot}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\NormalTok{year,}\DataTypeTok{y=}\NormalTok{total_value, }\DataTypeTok{col=}\NormalTok{category ))}\OperatorTok{+}\CommentTok{#plotting a line plot}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\DataTypeTok{na.rm=}\OtherTok{TRUE}\NormalTok{, }\DataTypeTok{size=}\DecValTok{1}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{size=}\NormalTok{.}\DecValTok{5}\NormalTok{,}\DataTypeTok{alpha =} \FloatTok{.5}\NormalTok{,}\DataTypeTok{color =} \StringTok{"black"}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_color_brewer}\NormalTok{(}\DataTypeTok{name=}\StringTok{''}\NormalTok{,}\DataTypeTok{palette=}\StringTok{'Paired'}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{theme_minimal}\NormalTok{()}\OperatorTok{+}
\StringTok{  }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{title=}\StringTok{'Japan Gas Emissions'}\NormalTok{,}
       \DataTypeTok{subtitle=} \StringTok{'in kilotons , from 1990-2018'}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{'year'}\NormalTok{)}\OperatorTok{+}\KeywordTok{ylab}\NormalTok{(}\StringTok{''}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Project_gollu_files/figure-latex/unnamed-chunk-37-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#visualizing bar plot to know the portion of each emission gases and compare with each other}
\NormalTok{ japan_emissions }\OperatorTok{%>%}\StringTok{ }\KeywordTok{group_by}\NormalTok{(category, year) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{summarise}\NormalTok{(}\DataTypeTok{total_value=}\KeywordTok{sum}\NormalTok{(value),}\DataTypeTok{.groups =} \StringTok{'drop'}\NormalTok{)}\OperatorTok{%>%}
\StringTok{  }\KeywordTok{ggplot}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\NormalTok{category, }\DataTypeTok{y=}\NormalTok{total_value,}\DataTypeTok{fill =}\NormalTok{ category))}\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_col}\NormalTok{(}\DataTypeTok{width =} \FloatTok{.6}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{axis.text.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{size=}\DecValTok{10}\NormalTok{))}\OperatorTok{+}\CommentTok{#increasing the length of x axis text}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Category"}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{(}\StringTok{"In kilotons equivalent"}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{title=}\StringTok{'Japan Gas Emissions'}\NormalTok{,}
       \DataTypeTok{subtitle=} \StringTok{'in kilotons , from 1990-2018'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Project_gollu_files/figure-latex/unnamed-chunk-38-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#lets find out the % of emission of each Japan gases from 1990 to 2018}
\NormalTok{japan_gas_wise_total <-}\StringTok{ }\NormalTok{japan_emissions}\OperatorTok{%>%}\StringTok{ }\KeywordTok{group_by}\NormalTok{(category) }\OperatorTok{%>%}\KeywordTok{summarise}\NormalTok{(}\DataTypeTok{total_value =} \KeywordTok{sum}\NormalTok{(value),}\DataTypeTok{.groups =} \StringTok{'drop'}\NormalTok{)}
\CommentTok{#find the sum of total country gas emission}
\NormalTok{japan_sum <-}\StringTok{ }\KeywordTok{sum}\NormalTok{(japan_gas_wise_total}\OperatorTok{$}\NormalTok{total_value)}
\CommentTok{#create a column name 'emission_percentage and calculate the % of contribution'}
\NormalTok{japan_percentage <-}\StringTok{ }\KeywordTok{mutate}\NormalTok{(japan_gas_wise_total, }\DataTypeTok{japan_emission_percentage =}\NormalTok{ (japan_gas_wise_total}\OperatorTok{$}\NormalTok{total_value}\OperatorTok{/}\NormalTok{japan_sum)}\OperatorTok{*}\DecValTok{100}\NormalTok{)}\OperatorTok{%>%}\StringTok{ }\KeywordTok{mutate_at}\NormalTok{(}\KeywordTok{vars}\NormalTok{(japan_emission_percentage), }\KeywordTok{funs}\NormalTok{(}\KeywordTok{round}\NormalTok{(., }\DecValTok{2}\NormalTok{)))}
\NormalTok{japan_percentage}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 9 x 3
##   category         total_value japan_emission_percentage
## * <chr>                  <dbl>                     <dbl>
## 1 CH4                 1145197.                      0.98
## 2 CO2                35944195.                     30.7 
## 3 GHG                39022712.                     33.3 
## 4 GHG_indirect_CO2   39031111.                     33.3 
## 5 HF3                   16772.                      0.01
## 6 HFC                  704438.                      0.6 
## 7 N2Os                 750053.                      0.64
## 8 PFCs                 247705.                      0.21
## 9 SF6                  214351.                      0.18
\end{verbatim}

\textbf{Germany emissions from 1990 to 2018}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#analysis of Germany country emissions }
\NormalTok{germany_emissions <-}\StringTok{ }\NormalTok{dataset[dataset}\OperatorTok{$}\NormalTok{country}\OperatorTok{==}\StringTok{'germany'}\NormalTok{,] }\CommentTok{#selecting data for a single country}
\NormalTok{germany_emissions }\OperatorTok{%>%}\StringTok{ }\KeywordTok{group_by}\NormalTok{(category, year) }\OperatorTok{%>%}\StringTok{ }\CommentTok{#grouping category and year together}
\StringTok{  }\KeywordTok{summarise}\NormalTok{(}\DataTypeTok{total_value=}\KeywordTok{sum}\NormalTok{(value),}\DataTypeTok{.groups =} \StringTok{'drop'}\NormalTok{)}\OperatorTok{%>%}
\StringTok{  }\KeywordTok{ggplot}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\NormalTok{year,}\DataTypeTok{y=}\NormalTok{total_value, }\DataTypeTok{col=}\NormalTok{category ))}\OperatorTok{+}\CommentTok{#plotting a line plot}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{(}\DataTypeTok{na.rm=}\OtherTok{TRUE}\NormalTok{, }\DataTypeTok{size=}\DecValTok{1}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{size=}\NormalTok{.}\DecValTok{5}\NormalTok{,}\DataTypeTok{alpha =} \FloatTok{.5}\NormalTok{,}\DataTypeTok{color =} \StringTok{"black"}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_color_brewer}\NormalTok{(}\DataTypeTok{name=}\StringTok{''}\NormalTok{,}\DataTypeTok{palette=}\StringTok{'Paired'}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{theme_minimal}\NormalTok{()}\OperatorTok{+}
\StringTok{  }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{title=}\StringTok{'Germany Gas Emissions'}\NormalTok{,}
       \DataTypeTok{subtitle=} \StringTok{'in kilotons , from 1990-2018'}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{'year'}\NormalTok{)}\OperatorTok{+}\KeywordTok{ylab}\NormalTok{(}\StringTok{''}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Project_gollu_files/figure-latex/unnamed-chunk-40-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#visualizing bar plot to know the portion of each emission gases and compare with each other}
\NormalTok{ germany_emissions }\OperatorTok{%>%}\StringTok{ }\KeywordTok{group_by}\NormalTok{(category, year) }\OperatorTok{%>%}\StringTok{ }
\StringTok{  }\KeywordTok{summarise}\NormalTok{(}\DataTypeTok{total_value=}\KeywordTok{sum}\NormalTok{(value),}\DataTypeTok{.groups =} \StringTok{'drop'}\NormalTok{)}\OperatorTok{%>%}
\StringTok{  }\KeywordTok{ggplot}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\NormalTok{category, }\DataTypeTok{y=}\NormalTok{total_value,}\DataTypeTok{fill =}\NormalTok{ category))}\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_col}\NormalTok{(}\DataTypeTok{width =} \FloatTok{.6}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{axis.text.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{size=}\DecValTok{10}\NormalTok{))}\OperatorTok{+}\CommentTok{#increasing the length of x axis text}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Category"}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{(}\StringTok{"In kilotons equivalent"}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{title=}\StringTok{'Germany Gas Emissions'}\NormalTok{,}
       \DataTypeTok{subtitle=} \StringTok{'in kilotons , from 1990-2018'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Project_gollu_files/figure-latex/unnamed-chunk-41-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#lets find out the % of emission of each Japan gases from 1990 to 2018}
\NormalTok{germany_gas_wise_total <-}\StringTok{ }\NormalTok{germany_emissions}\OperatorTok{%>%}\StringTok{ }\KeywordTok{group_by}\NormalTok{(category) }\OperatorTok{%>%}\KeywordTok{summarise}\NormalTok{(}\DataTypeTok{total_value =} \KeywordTok{sum}\NormalTok{(value),}\DataTypeTok{.groups =} \StringTok{'drop'}\NormalTok{)}
\CommentTok{#find the sum of total country gas emission}
\NormalTok{germany_sum <-}\StringTok{ }\KeywordTok{sum}\NormalTok{(germany_gas_wise_total}\OperatorTok{$}\NormalTok{total_value)}
\CommentTok{#create a column name 'emission_percentage and calculate the % of contribution'}
\NormalTok{germany_percentage <-}\StringTok{ }\KeywordTok{mutate}\NormalTok{(germany_gas_wise_total, }\DataTypeTok{germany_emission_percentage =}\NormalTok{ (germany_gas_wise_total}\OperatorTok{$}\NormalTok{total_value}\OperatorTok{/}\NormalTok{germany_sum)}\OperatorTok{*}\DecValTok{100}\NormalTok{)}\OperatorTok{%>%}\StringTok{ }\KeywordTok{mutate_at}\NormalTok{(}\KeywordTok{vars}\NormalTok{(germany_emission_percentage), }\KeywordTok{funs}\NormalTok{(}\KeywordTok{round}\NormalTok{(., }\DecValTok{2}\NormalTok{)))}
\NormalTok{germany_percentage}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 10 x 3
##    category         total_value germany_emission_percentage
##  * <chr>                  <dbl>                       <dbl>
##  1 CH4                 2270162.                        2.66
##  2 CO2                25538180.                       30.0 
##  3 GHG                29598643.                       34.7 
##  4 GHG_indirect_CO2   26030606.                       30.5 
##  5 HF3                     514.                        0   
##  6 HFC                  206257.                        0.24
##  7 HFC-PFC-mix           62914.                        0.07
##  8 N2Os                1370390.                        1.61
##  9 PFCs                  31578.                        0.04
## 10 SF6                  118650.                        0.14
\end{verbatim}

\textbf{Total emission of gases around the world from 1990-2018 and each
country's share \%}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{total_gases_by_each_country <-}\StringTok{ }\NormalTok{dataset}\OperatorTok{%>%}\StringTok{ }\KeywordTok{group_by}\NormalTok{(country) }\OperatorTok{%>%}\KeywordTok{summarise}\NormalTok{(}\DataTypeTok{total_value =} \KeywordTok{sum}\NormalTok{(value),}\DataTypeTok{.groups =} \StringTok{'drop'}\NormalTok{)}
\CommentTok{#find the sum of total country gas emission}
\NormalTok{total_sum <-}\StringTok{ }\KeywordTok{sum}\NormalTok{(total_gases_by_each_country}\OperatorTok{$}\NormalTok{total_value)}
\CommentTok{#create a column name 'emission_percentage and calculate the % of contribution'}
\NormalTok{each_country_percentage <-}\StringTok{ }\KeywordTok{mutate}\NormalTok{(total_gases_by_each_country, }\DataTypeTok{country_emission_percentage =}\NormalTok{ (total_gases_by_each_country}\OperatorTok{$}\NormalTok{total_value}\OperatorTok{/}\NormalTok{total_sum)}\OperatorTok{*}\DecValTok{100}\NormalTok{)}\OperatorTok{%>%}\StringTok{ }\KeywordTok{mutate_at}\NormalTok{(}\KeywordTok{vars}\NormalTok{(country_emission_percentage), }\KeywordTok{funs}\NormalTok{(}\KeywordTok{round}\NormalTok{(., }\DecValTok{2}\NormalTok{)))}
\CommentTok{#sorting the data from highest to lowest using order}
\NormalTok{each_country_percentage<-}\StringTok{ }\NormalTok{each_country_percentage[}\KeywordTok{order}\NormalTok{(each_country_percentage}\OperatorTok{$}\NormalTok{country_emission_percentage,}\DataTypeTok{decreasing =} \OtherTok{TRUE}\NormalTok{),]}

\NormalTok{each_country_percentage}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 43 x 3
##    country   total_value country_emission_percentage
##    <chr>           <dbl>                       <dbl>
##  1 usa        573840505.                       38.6 
##  2 russia     212216466.                       14.3 
##  3 japan      117076535.                        7.88
##  4 germany     85227893.                        5.74
##  5 canada      58744677.                        3.95
##  6 france      44216187.                        2.98
##  7 italy       43052403.                        2.9 
##  8 australia   40841736.                        2.75
##  9 ukraine     40520112.                        2.73
## 10 uk          38679656.                        2.6 
## # ... with 33 more rows
\end{verbatim}

\#Top 4 countries vs all other countries contribution

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#selecting top 4 countries data}
\NormalTok{top_}\DecValTok{4}\NormalTok{_countries <-}\StringTok{ }\NormalTok{each_country_percentage[}\DecValTok{1}\OperatorTok{:}\DecValTok{4}\NormalTok{,]}

\CommentTok{#selcting remaining all other countries sum of 'total_value' and emission percentage}
\NormalTok{remaining_}\DecValTok{39}\NormalTok{_countries <-}\StringTok{ }\NormalTok{each_country_percentage[}\DecValTok{5}\OperatorTok{:}\DecValTok{43}\NormalTok{,]}
\NormalTok{total_value <-}\StringTok{ }\KeywordTok{sum}\NormalTok{(remaining_}\DecValTok{39}\NormalTok{_countries}\OperatorTok{$}\NormalTok{total_value)}
\NormalTok{country_emission_percentage <-}\StringTok{ }\KeywordTok{sum}\NormalTok{(remaining_}\DecValTok{39}\NormalTok{_countries}\OperatorTok{$}\NormalTok{country_emission_percentage)}
\NormalTok{country <-}\StringTok{ "All other countries"}
\NormalTok{rest_of_countries_data <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(country,total_value,country_emission_percentage)}
\NormalTok{final_data <-}\StringTok{ }\KeywordTok{rbind}\NormalTok{(top_}\DecValTok{4}\NormalTok{_countries,rest_of_countries_data)}
\NormalTok{final_data}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 5 x 3
##   country             total_value country_emission_percentage
##   <chr>                     <dbl>                       <dbl>
## 1 usa                  573840505.                       38.6 
## 2 russia               212216466.                       14.3 
## 3 japan                117076535.                        7.88
## 4 germany               85227893.                        5.74
## 5 All other countries  497642284.                       33.5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#graphical representation of top 4 countries VS all other countries}
\NormalTok{pie <-}\StringTok{ }\KeywordTok{ggplot}\NormalTok{(final_data,}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\StringTok{""}\NormalTok{,}\DataTypeTok{y=}\NormalTok{country_emission_percentage,}\DataTypeTok{fill =}\NormalTok{ country))}\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_bar}\NormalTok{(}\DataTypeTok{stat =} \StringTok{"identity"}\NormalTok{,}\DataTypeTok{colour=}\StringTok{"gray"}\NormalTok{)}
\NormalTok{pie}\OperatorTok{+}\KeywordTok{coord_polar}\NormalTok{(}\StringTok{"y"}\NormalTok{, }\DataTypeTok{start=}\DecValTok{0}\NormalTok{,}\DataTypeTok{direction =} \DecValTok{1}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_text}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{label =}\NormalTok{ country_emission_percentage), }\DataTypeTok{position =} \KeywordTok{position_stack}\NormalTok{(}\DataTypeTok{vjust =} \FloatTok{0.5}\NormalTok{))}\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\StringTok{"top 4 countries vs all other countries"}\NormalTok{,}\DataTypeTok{subtitle =} \StringTok{"from the year 1990 -2018"}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{(}\StringTok{"In emission %"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{R_Project_gollu_files/figure-latex/unnamed-chunk-45-1.pdf}

\textbf{key findings and conclusions}

\begin{Shaded}
\begin{Highlighting}[]
\StringTok{"ikkada raayali and codigng comments add cheyali after that it's done. succesfully."}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "ikkada raayali and codigng comments add cheyali after that it's done. succesfully."
\end{verbatim}

\end{document}
